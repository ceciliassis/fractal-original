time limit: 5:00:00
step 5: exceeded time limit
num patterns: step 2: 2, step 3: 6, step 4: 21
